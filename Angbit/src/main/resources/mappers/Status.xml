<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="StatusDao">
	<select id="StatusList" parameterType="java.lang.String" resultType="CoinCoinInfo">
		select c.*, ci.coinname from coin c inner join coininfo ci on c.coincode=ci.coincode where id=#{id} and coin_amt != 0 order by c.coincode asc
	</select>
	<select id="KrwList" parameterType="java.lang.String" resultType="MemberInfo">
		select krw from memberinfo where id=#{id} 
	</select>
	<select id="YList" parameterType="hashmap" resultType="TradeCoinInfo">
<!-- 		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_stu=1 and rownum between #{trdCoin.start} and #{trdCoin.end} order by trd_date desc -->
		select * from (select rownum rn, a.* from(select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_stu=1 order by trd_date desc )a) where rn between #{trdCoin.start} and #{trdCoin.end}
	</select>
	<select id="NList" parameterType="java.lang.String" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_stu=0 order by trd_date desc
	</select>
	<select id="TotPrice" parameterType="java.lang.String" resultType="int">
		select nvl(sum(tot_price), 0) from coin where id=#{id} and coin_amt != 0
	</select>
	<select id="CBuyList" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_stu=1 and trd_div=0 order by trd_date desc 
	</select>
	<select id="CSellList" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_stu=1 and trd_div=1 order by trd_date desc 
	</select>
	
	<!-- 기간별 전체정렬 -->
	<select id="AllDateSort7" parameterType="java.lang.String" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_date >= to_char(sysdate-7, 'yyyymmdd') and trd_stu=1 order by trd_date desc
	</select>
	<select id="AllDateSort30" parameterType="java.lang.String" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_date >= to_char(sysdate-30, 'yyyymmdd') and trd_stu=1 order by trd_date desc
	</select>
	<select id="AllDateSort90" parameterType="java.lang.String" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_date >= to_char(sysdate-90, 'yyyymmdd') and trd_stu=1 order by trd_date desc
	</select>
	<select id="AllDateSort180" parameterType="java.lang.String" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_date >= to_char(sysdate-180, 'yyyymmdd') and trd_stu=1 order by trd_date desc
	</select>
	
	<!-- 기간별 매수정렬 -->
	<select id="buyDateSort7" parameterType="java.lang.String" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_date >= to_char(sysdate-7, 'yyyymmdd') and trd_stu=1 and trd_div=0 order by trd_date desc
	</select>
	<select id="buyDateSort30" parameterType="java.lang.String" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_date >= to_char(sysdate-30, 'yyyymmdd') and trd_stu=1 and trd_div=0 order by trd_date desc
	</select>
	<select id="buyDateSort90" parameterType="java.lang.String" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_date >= to_char(sysdate-90, 'yyyymmdd') and trd_stu=1 and trd_div=0 order by trd_date desc
	</select>
	<select id="buyDateSort180" parameterType="java.lang.String" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_date >= to_char(sysdate-180, 'yyyymmdd') and trd_stu=1 and trd_div=0 order by trd_date desc
	</select>
	
	<!-- 기간별 매도정렬 -->
	<select id="sellDateSort7" parameterType="java.lang.String" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_date >= to_char(sysdate-7, 'yyyymmdd') and trd_stu=1 and trd_div=1 order by trd_date desc
	</select>
	<select id="sellDateSort30" parameterType="java.lang.String" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_date >= to_char(sysdate-30, 'yyyymmdd') and trd_stu=1 and trd_div=1 order by trd_date desc
	</select>
	<select id="sellDateSort90" parameterType="java.lang.String" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_date >= to_char(sysdate-90, 'yyyymmdd') and trd_stu=1 and trd_div=1 order by trd_date desc
	</select>
	<select id="sellDateSort180" parameterType="java.lang.String" resultType="TradeCoinInfo">
		select t.*, c.coinname from trade t inner join coininfo c on t.coincode=c.coincode where id=#{id} and trd_date >= to_char(sysdate-180, 'yyyymmdd') and trd_stu=1 and trd_div=1 order by trd_date desc
	</select>
	<select id="StatusTotal" parameterType="java.lang.String" resultType="int">
		select count(*) from trade where id=#{id} and trd_stu=1
	</select>
</mapper>
