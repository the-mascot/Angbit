<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="BoardDao">
	
	<!-- getList -->
	<select id="boardList" parameterType="Board" resultType="Board">
		SELECT  *
		FROM
		 board bd
		LEFT OUTER JOIN
		 memberinfo mb
		ON 
		 bd.id = mb.id
		ORDER BY bd.b_num DESC
	</select>
	
	
	<!-- total -->
	<select id="dyboardTotal" resultType="int">
		select count(*) FROM board
	</select>
	
	<select id="pagingbd" parameterType="Board" resultType="Board">
		SELECT *
		FROM
		  (
		    Select rownum rn , a.*
		    From   (select * from board order by b_num DESC) a
		  )
			WHERE rn between #{start} and #{end} 
	</select>
	
	
	<!-- detail, updateForm -->
	<select id="dyBoardSelOne" parameterType="int" resultType="Board">
		SELECT * 
		FROM Board bd
		LEFT OUTER JOIN memberinfo mb
		ON bd.id = mb.id
		WHERE b_num = #{b_num}
	</select>
	
	<update id="dyViewCnt" parameterType="int">
		UPDATE board
		SET views = views+1
		WHERE b_num = #{b_num}
	</update>
	
	
	<!-- update -->
	<update id="dyBoardUpdate" parameterType="Board">
		 update board 
		 set title=#{title}, content=#{content}, uploaddate=sysdate
		 where b_num=#{b_num}
	</update>
	
	<select id="writeBoard" resultType="Board">
		SELECT * 
		FROM Board bd
		LEFT OUTER JOIN memberinfo mb
		ON bd.id = mb.id
	</select>
	
	
	<!-- delete -->
	<delete id="delete" parameterType="int">
		delete from BOARD where b_num = #{b_num}
	</delete>
	
	<!-- insert -->
	<insert id="dyBoardInsert" parameterType="board">
	     insert ALL 
	     into board values(#{title},#{content})
		 into memberinfo values(#{nickname})					 
 	</insert>
	
</mapper>