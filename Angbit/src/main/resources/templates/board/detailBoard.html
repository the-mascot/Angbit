<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>세부내용</title>

<!-- Common meta tag, Bootstrap, js -->
<th:block th:replace="common/commonHead"></th:block>

<!-- Jquery -->
<script th:src="@{https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js}"></script>

<script> 
history.pushState(null, null, 'board_list'); //data, title, url 의 값이 들어가게 됩니다. 비워두면 이벤트 발생의 플래그
											 //기존페이지 이외에 입력한 URL로 페이지가 하나 더 만들어지는 것 
	window.onpopstate = function(event) {
		history.back(); 
    	console.log('뒤로가기 체크'); 
    } 
</script>



</head>
<body>

<!-- common 헤더 -->
<header th:replace="common/header :: header"></header>

<main>
<div class="container">
	<div class="row bg-warning">
		<div class="col-lg-1"></div>
		<div class="col-lg-10">
			<div class="row">
				<div class="col-lg-2 bg-warning"><div align="center" class="textbox text-dark fs-3 fw-bold">상세게시글</div></div>
				<div class="col-lg-10"></div>
			</div>
		</div>	
		<div class="col-lg-1"></div>
	</div>
	
	<table class="table">
		<tr><th>순번</th><td th:text="${board.b_num }"></td>
			<th>제목</th><td th:text="${board.title }"></td>
			<th>작성일</th><td th:text="${#dates.format(board.uploaddate, 'yyyy-MM-dd')}"></td>
			<th>조회수</th><td th:text="${board.views }"></td>
			<th>닉네임</th><td th:text="${board.nickname }"></td>
		</tr>
			<table class="table">
				<tr><th>내용</th><td th:text="${board.content}"></td></tr>
			</table>
	</table>
	
	<div class="row"><div class="col-lg-12">&nbsp</div></div>  <!--한줄 띄기  -->
	<div class="row"><div class="col-lg-12">&nbsp</div></div>  <!--한줄 띄기  -->
	
	<!-- 목록,수정,삭제 -->
	<div class=row>
		<div class="col-lg-10"></div>
		<div class="col-lg-2">
			<div class="btn-group" role="group" aria-label="Basic outlined example">
				<input type="button" class="btn btn-outline-dark" th:value="목록" 
					th:onclick="|location.href='@{board_list}'|">
				<input type="button" class="btn btn-outline-dark" th:value="수정" 
					th:onclick="|location.href='@{board_updateForm(ref=${board.ref})}'|"> 		<!-- updateform으로b_num을 넘겨줌 -->
				<input type="button" class="btn btn-outline-dark" th:value="삭제" 
					th:onclick="|location.href='@{delete(ref=${board.ref})}'|">
			</div>	
		</div>
	</div>
	
	
	
	
	
	<div class="row"><div class="col-lg-12">&nbsp</div></div>  <!--한줄 띄기  -->
	
	
	
	<hr>
	
	
<!-- DB 댓글 추가 -->
<form action="board_detailBoard" method="get">
		
		<input type="hidden"  name="b_num"       value="${board.b_num}">
		<input type="hidden"  name="id"          value="${board.id}">
		<input type="hidden"  name="uploaddate"  value="SYSDATE">
		<input type="hidden"  name="title"       value="${board.title}">
		<input type="hidden"  name="views"       value="${board.views}">
		<input type="hidden"  name="ref"         value="${board.ref}">
		<input type="hidden"  name="re_level"    value="1">	
		<input type="hidden"  name="re_step"     value="0">	
		<input type="hidden"  name="nickname"    value="${session.sessionNickName}">
		
	<!-- textarea -->
		<label for="exampleFormControlTextarea1" class="form-label fs-5 fw-bold" th:if="${session.sessionID!=null}">댓글작성</label>
		<div class="form-floating">
		<textarea class="form-control h-25" rows="5" name="content" required="required" th:if="${session.sessionID!=null}"></textarea>
		</div>
													
	<div class="row"><div class="col-lg-12">&nbsp</div></div> <!--한줄 띄기  -->
	
	<!-- 입력버튼 -->
	<div class="row">
		<div class="col-lg-10"></div>
		<div class="col-lg-2"><button class="btn btn-outline-dark col-6" type="submit" th:if="${session.sessionID!=null}">입력</button></div>
	</div>
</form>

<div class="row"><div class="col-lg-12">&nbsp</div></div> <!--한줄 띄기  -->

	<div class=row>
		<div class="col-lg-10"></div>
		<div class="col-lg-2"></div>
	</div>
	
<div class="row"><div class="col-lg-12">&nbsp</div></div> <!--한줄 띄기  -->







<!-- 댓글 보이는곳 -->
	
<div class="box">
		<div class="row">
		    <div class="col-lg-1 border border-warning">#</div>
			<div class="col-lg-1 border border-warning">글쓴이</div>
			<div class="col-lg-5 border border-warning">내용</div>
			<div class="col-lg-2 border border-warning">작성일</div>
			<div class="col-lg-2 border border-warning">#</div>
		</div>	
	
	<div class="row"><div class="col-lg-12">&nbsp</div></div> <!--한줄 띄기  -->
	
		<div class="row border-bottom">
		    <div class="col-lg-1  align-self-center">#</div>
			<div class="col-lg-1  align-self-center" th:text="${levone.nickname}">글쓴이</div>
			<div class="col-lg-5  align-self-center" th:text="${levone.content}">내용</div>
			<div class="col-lg-2  align-self-center" th:text="${levone.uploaddate}">작성일</div>
			
			<div class="col-lg-1"  th:if="session.sessionID!=null and session.sessionNickName==${levone.nickname}">
				<div class="btn-group" role="group" aria-label="Basic outlined example" th:if="${session.sessionID!=null}">
					<input type="button" class="btn btn-outline-dark" th:value="댓글수정" 
						th:onclick="|location.href='@{reply_updateForm(ref=${board.ref}, re_step=${levone.re_step})}'|"> 		
					<input type="button" class="btn btn-outline-dark" th:value="댓글삭제" 
						th:onclick="|location.href='@{reply_delete(ref=${board.ref}, re_step=${levone.re_step})}'|">
				</div>	
			</div>
			
			<div class="col-lg-2"></div>
		</div>
	
	
</div>


</div> <!-- container -->
</main>
<!-- footer -->
<footer th:replace="common/footer :: footer"></footer>

<!-- Bootstrap Bundle with Popper -->
<script th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js}" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</body>
</html>